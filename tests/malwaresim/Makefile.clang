#
# Makefile for building unit tests with Google Test.
#

CXX = clang++

GUNIT_BASE += ../gtest-1.7.0
GUNIT_PATH += $(GUNIT_BASE)/include

COMPILER_FLAGS += \
    -I$(GUNIT_PATH) \
    -I../src -I../src/malwaresim \
    -g -std=c++11 \
    -Weverything \
    -Wno-unused-function \
    -Wno-unused-parameter \
    -Wno-unused-exception-parameter \
    -Wno-weak-vtables \
    -Wno-padded \
    -Wno-switch-enum \
    -Wno-cast-align \
    -Wno-c++11-long-long \
    -Wno-covered-switch-default \
    -Wno-missing-prototypes \
    -Wno-c++11-extensions \
    -Wno-c++98-compat \
    -Wno-c++98-compat-pedantic \
    -Wno-exit-time-destructors \
    -Wno-global-constructors \
    -Wno-undef \
    -Wno-missing-noreturn \
    -Wno-shift-sign-overflow \
    -Wno-used-but-marked-unused \
    -Wno-deprecated

LIBS = $(GUNIT_BASE)/make/gtest_main.a -lpthread

# Tests
FILES += ../tests/malwaresim/DeviceTests.cxx

main: $(FILES)
	$(CXX) $(COMPILER_FLAGS) $(FILES) $(LIBS) -o unittests


all: main

clean:
	rm -rf unittests
